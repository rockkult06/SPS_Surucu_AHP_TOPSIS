(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[437],{13010:function(e,t,r){Promise.resolve().then(r.bind(r,55429))},55429:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return R}});var a=r(3827),s=r(64090),l=r(85754),i=r(27815),n=r(49842),o=r(19160),d=r(77929),c=r(98998),u=r(46578),m=r(28814),h=r(34059),f=r(44715),x=r(14323),p=r(92493);r(25264);var g=r(61370),j=r(54900),b=r(40894),y=r(23441),S=r(85159),v=r(80037),N=r(1657);let k=b.fC;b.ZA;let w=b.B4,C=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(b.xz,{ref:t,className:(0,N.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...l,children:[s,(0,a.jsx)(b.JO,{asChild:!0,children:(0,a.jsx)(y.Z,{className:"h-4 w-4 opacity-50"})})]})});C.displayName=b.xz.displayName;let P=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(b.u_,{ref:t,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(S.Z,{className:"h-4 w-4"})})});P.displayName=b.u_.displayName;let _=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(b.$G,{ref:t,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(y.Z,{className:"h-4 w-4"})})});_.displayName=b.$G.displayName;let T=s.forwardRef((e,t)=>{let{className:r,children:s,position:l="popper",...i}=e;return(0,a.jsx)(b.h_,{children:(0,a.jsxs)(b.VY,{ref:t,className:(0,N.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:l,...i,children:[(0,a.jsx)(P,{}),(0,a.jsx)(b.l_,{className:(0,N.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(_,{})]})})});T.displayName=b.VY.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(b.__,{ref:t,className:(0,N.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...s})}).displayName=b.__.displayName;let I=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(b.ck,{ref:t,className:(0,N.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(b.wU,{children:(0,a.jsx)(v.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(b.eT,{children:s})]})});I.displayName=b.ck.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(b.Z0,{ref:t,className:(0,N.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=b.Z0.displayName;var O=r(75083),A=r(47907),E=r(74889),z=r(80831);function R(){let[e,t]=(0,s.useState)([]),[r,b]=(0,s.useState)({}),[y,S]=(0,s.useState)([]),[v,N]=(0,s.useState)(null),[P,_]=(0,s.useState)(!1),[R,D]=(0,s.useState)([]),[F,Z]=(0,s.useState)({}),[M,H]=(0,s.useState)(!1),[K,X]=(0,s.useState)(!1),[Y,V]=(0,s.useState)(""),[L,U]=(0,s.useState)([]),[J,B]=(0,s.useState)([]),{toast:q}=(0,O.pm)(),W=(0,A.useRouter)(),[G,$]=(0,z._)("evaluatorName",""),{getItem:Q}=(0,z.R)("ahpEvaluations"),{getItem:ee}=(0,z.R)("hierarchicalEvaluations"),et=(0,s.useMemo)(()=>(0,g.RR)(),[]),er=(0,s.useMemo)(()=>(0,g.gb)(),[]);(0,s.useEffect)(()=>{let e=Q(),t=ee(),r=[];if(e)try{let t=JSON.parse(e);r.push(...t)}catch(e){console.error("Error parsing AHP evaluations:",e)}if(t)try{let e=JSON.parse(t);r.push(...e)}catch(e){console.error("Error parsing hierarchical evaluations:",e)}U(r)},[]),(0,s.useEffect)(()=>{if(0===J.length){b({}),X(!1);return}let e=L.filter(e=>J.includes(e.id));if(0===e.length)return;let t={};et.forEach(r=>{let a=e.map(e=>e.globalWeights[r.id]||0).filter(e=>e>0);a.length>0&&(t[r.id]=a.reduce((e,t)=>e+t,0)/a.length)}),b(t),X(!0),D(Object.keys(t));let r={};Object.keys(t).forEach(e=>{r[e]=(0,g.rc)(e)||!1}),Z(r),N(null)},[J,L,et]);let ea=(e,t)=>{B(r=>t?[...r,e]:r.filter(t=>t!==e))},es=e=>{B(e?L.map(e=>e.id):[])},el=async()=>{if(0===e.length){N("L\xfctfen \xf6nce s\xfcr\xfcc\xfc verilerini y\xfckleyin.");return}if(!K&&!M){N("AHP ağırlıkları bulunamadı. L\xfctfen AHP değerlendirmesi yapın veya varsayılan ağırlıkları kullanın.");return}if(0===R.length){N("L\xfctfen TOPSIS hesaplaması i\xe7in en az bir kriter se\xe7in.");return}_(!0),N(null);try{let t={};if(M||!K){let e=1/R.length;R.forEach(r=>{t[r]=e}),console.log("Using default equal weights:",t)}else R.forEach(e=>{t[e]=r[e]||0}),console.log("Using AHP weights:",t);let a=new FormData,s=x.P6.json_to_sheet(e.map(e=>{let t={"Sicil No":e.driverId,"Sefer Sayısı":e.tripCount||0,"Yapılan Kilometre":e.distance||0};return et.forEach(r=>{t[r.name]=e[r.id]||0}),t})),l=x.P6.book_new();x.P6.book_append_sheet(l,s,"Veriler");let i=x.cW(l,{type:"array",bookType:"xlsx"}),n=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});a.append("file",n,"driver_data.xlsx"),a.append("globalWeights",JSON.stringify(t)),a.append("minTripCount","0"),a.append("minDistance","0");let o=await fetch("/api/topsis",{method:"POST",body:a});if(!o.ok){let e=await o.json();throw Error(e.error||"TOPSIS hesaplaması başarısız")}let d=await o.json();S(d.results||[]),M?console.log("TOPSIS hesaplaması varsayılan eşit ağırlıklarla tamamlandı"):console.log("TOPSIS hesaplaması AHP ağırlıklarıyla tamamlandı"),localStorage.setItem("topsisResults",JSON.stringify({topsisResults:d.results||[]})),console.log("localStorage sonrası:",JSON.parse(localStorage.getItem("topsisResults")||"{}")),q({title:"TOPSIS Analizi Başarıyla tamamlandı.",description:"Toplu Sonu\xe7lar sayfasından kontrol ediniz."}),await new Promise(e=>setTimeout(e,100)),W.push("/all-results")}catch(e){console.error("Error calculating TOPSIS:",e),N(e instanceof Error?e.message:"TOPSIS hesaplaması sırasında bir hata oluştu.")}finally{_(!1)}},ei=(e,t)=>{D(r=>t?[...r,e]:r.filter(t=>t!==e))},en=(e,t)=>{Z(r=>({...r,[e]:"benefit"===t}))};return(0,a.jsx)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:(0,a.jsxs)(i.Zb,{className:"card-shadow overflow-hidden border-0 mb-8",children:[(0,a.jsxs)(i.Ol,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-primary-foreground py-8",children:[(0,a.jsx)(i.ll,{className:"text-2xl font-bold",children:"TOPSIS Analizi"}),(0,a.jsx)(i.SZ,{className:"text-primary-foreground/90",children:"S\xfcr\xfcc\xfc verilerini y\xfckleyin ve TOPSIS analizi yapın."})]}),(0,a.jsxs)(i.aY,{className:"p-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"AHP Ağırlıkları"}),0===L.length?(0,a.jsxs)(d.bZ,{children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)(d.Cd,{children:"AHP Değerlendirmesi Bulunamadı"}),(0,a.jsx)(d.X,{children:"L\xfctfen \xf6nce AHP değerlendirmesi yapın veya varsayılan eşit ağırlıkları kullanın."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)(l.z,{onClick:()=>es(!0),variant:"outline",size:"sm",children:"T\xfcm\xfcn\xfc Se\xe7"}),(0,a.jsx)(l.z,{onClick:()=>es(!1),variant:"outline",size:"sm",children:"Se\xe7imi Temizle"})]})}),(0,a.jsxs)(o.iA,{children:[(0,a.jsx)(o.xD,{children:(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.ss,{className:"w-12",children:"Se\xe7"}),(0,a.jsx)(o.ss,{children:"Değerlendirici"}),(0,a.jsx)(o.ss,{children:"Tarih"}),(0,a.jsx)(o.ss,{children:"Tutarlılık (CR)"}),(0,a.jsx)(o.ss,{children:"Tutarlı mı?"})]})}),(0,a.jsx)(o.RM,{children:L.map(e=>(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.pj,{children:(0,a.jsx)(j.X,{checked:J.includes(e.id),onCheckedChange:t=>ea(e.id,t)})}),(0,a.jsx)(o.pj,{children:e.evaluatorName}),(0,a.jsx)(o.pj,{children:new Date(e.date).toLocaleDateString("tr-TR")}),(0,a.jsx)(o.pj,{children:e.mainCR.toFixed(4)}),(0,a.jsx)(o.pj,{children:e.isOverallConsistent?(0,a.jsx)(u.Z,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(c.Z,{className:"h-5 w-5 text-red-500"})})]},e.id))})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)(n._,{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.X,{checked:M,onCheckedChange:e=>{H(e),e&&B([])}}),(0,a.jsx)("span",{children:"Varsayılan eşit ağırlıkları kullan"})]})})]}),(0,a.jsxs)("div",{className:"space-y-8",children:[v&&(0,a.jsxs)(d.bZ,{variant:"destructive",className:"mb-6 rounded-xl",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)(d.Cd,{children:"Hata"}),(0,a.jsx)(d.X,{children:v})]}),(0,a.jsxs)(d.bZ,{className:"mb-6 rounded-xl bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-900/30",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),(0,a.jsx)(d.X,{className:"text-blue-800 dark:text-blue-200",children:"TOPSIS analizi i\xe7in s\xfcr\xfcc\xfc verilerini i\xe7eren bir Excel dosyası y\xfckleyin. Dosyanızın ilk satırında 'Sicil No', 'Sefer Sayısı', 'Yapılan Kilometre' ve diğer kriter başlıkları bulunmalıdır."})]}),!K&&(0,a.jsxs)(d.bZ,{className:"mb-6 rounded-xl bg-amber-50 border-amber-200 dark:bg-amber-900/20 dark:border-amber-900/30",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),(0,a.jsx)(d.X,{className:"text-amber-800 dark:text-amber-200",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{children:"AHP değerlendirmesi bulunamadı. İki se\xe7eneğiniz var:"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.X,{id:"use-default-weights",checked:M,onCheckedChange:e=>H(!0===e)}),(0,a.jsxs)(n._,{htmlFor:"use-default-weights",className:"cursor-pointer",children:[(0,a.jsx)("strong",{children:"Varsayılan Eşit Ağırlıkları Kullan"})," - T\xfcm kriterler eşit \xf6nemde değerlendirilir (",(100/et.length).toFixed(1),"% her biri)"]})]}),(0,a.jsxs)("p",{className:"text-sm",children:["Daha doğru sonu\xe7lar i\xe7in \xf6nce ",(0,a.jsx)("strong",{children:"AHP değerlendirmesi"})," yapmanız \xf6nerilir."]})]})})]}),K&&(0,a.jsxs)(d.bZ,{className:"mb-6 rounded-xl bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-900/30",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),(0,a.jsx)(d.X,{className:"text-green-800 dark:text-green-200",children:"AHP değerlendirmesi başarıyla y\xfcklendi. Kriter ağırlıkları hesaplanmış durumda."})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-end mb-8",children:[(0,a.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,a.jsx)(n._,{htmlFor:"data-upload",children:"S\xfcr\xfcc\xfc Verilerini Y\xfckle (Excel)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("input",{id:"data-upload",type:"file",accept:".xlsx, .xls",onChange:e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(!a)return;V(a.name),_(!0),N(null);let s=new FileReader;s.onload=e=>{try{var r;let a=new Uint8Array(null===(r=e.target)||void 0===r?void 0:r.result),s=x.ij(a,{type:"array"}),l=s.SheetNames[0],i=s.Sheets[l],n=x.P6.sheet_to_json(i).map((e,t)=>{let r={};e&&Object.keys(e).forEach(t=>{t&&(r[t.trim()]=e[t])}),t<3&&(console.log("Row ".concat(t,":"),r),console.log("Available keys:",Object.keys(r)));let a={driverId:r["Sicil No"]||r.SicilNo||r["sicil no"]||"Driver_".concat(t),tripCount:r["Sefer Sayısı"]||r["sefer sayısı"]||0,distance:r["Yapılan Kilometre"]||r["yapılan kilometre"]||0};return t<3&&console.log("Extracted driver info:",{driverId:a.driverId,tripCount:a.tripCount,distance:a.distance}),et.forEach(e=>{let s=0;if(void 0!==r[e.name]){let t=r[e.name];"string"==typeof t?s=Number.parseFloat(t.replace(",","."))||0:"number"==typeof t&&(s=t)}else{let t=Object.keys(er).find(t=>er[t]===e.id);if(t&&void 0!==r[t]){let e=r[t];"string"==typeof e?s=Number.parseFloat(e.replace(",","."))||0:"number"==typeof e&&(s=e)}}a[e.id]=s,0===t&&console.log("Criterion ".concat(e.name," (").concat(e.id,"): ").concat(s))}),a});t(n),S([])}catch(e){console.error("Error reading Excel file:",e),N("Excel dosyası okunurken bir hata oluştu. L\xfctfen formatı kontrol edin.")}finally{_(!1)}},s.readAsArrayBuffer(a)},disabled:P,className:"hidden"}),(0,a.jsx)(l.z,{type:"button",onClick:()=>{var e;return null===(e=document.getElementById("data-upload"))||void 0===e?void 0:e.click()},className:"bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg",disabled:P,children:"Dosya Se\xe7"}),(0,a.jsx)("span",{className:"text-sm text-gray-500 truncate max-w-[180px]",children:Y||"Dosya se\xe7ilmedi"})]})]}),(0,a.jsx)(l.z,{onClick:el,disabled:P||0===e.length||0===R.length,className:"h-10 px-6 text-base font-semibold bg-green-600 hover:bg-green-700 text-white shadow-md disabled:bg-gray-300 disabled:text-gray-500",children:P?"Hesaplanıyor...":"TOPSIS Sıralamasını Hesapla"})]}),e.length>0&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Y\xfcklenen S\xfcr\xfcc\xfc Verileri (",e.length," Kayıt)"]}),(0,a.jsx)("div",{className:"max-h-60 overflow-y-auto border rounded-md",children:(0,a.jsxs)(o.iA,{children:[(0,a.jsx)(o.xD,{children:(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.ss,{children:"Sicil No"}),(0,a.jsx)(o.ss,{children:"Sefer Sayısı"}),(0,a.jsx)(o.ss,{children:"Kilometre"}),et.map(e=>(0,a.jsx)(o.ss,{children:e.name},e.id))]})}),(0,a.jsxs)(o.RM,{children:[e.slice(0,5).map((e,t)=>(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.pj,{children:e.driverId}),(0,a.jsx)(o.pj,{children:e.tripCount}),(0,a.jsx)(o.pj,{children:e.distance}),et.map(t=>(0,a.jsx)(o.pj,{children:e[t.id]},t.id))]},t)),e.length>5&&(0,a.jsx)(o.SC,{children:(0,a.jsxs)(o.pj,{colSpan:et.length+3,className:"text-center text-muted-foreground",children:["... ",e.length-5," diğer kayıtlar"]})})]})]})})]}),Object.keys(r).length>0&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"AHP Global Kriter Ağırlıkları"}),(0,a.jsxs)(l.z,{onClick:()=>W.push("/aggregate"),variant:"outline",className:"flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),"Toplu Ağırlıklar"]})]}),(0,a.jsxs)(o.iA,{className:"mb-4",children:[(0,a.jsx)(o.xD,{children:(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.ss,{children:"Kriter"}),(0,a.jsx)(o.ss,{className:"text-right",children:"Ağırlık"}),(0,a.jsx)(o.ss,{className:"text-center",children:"Se\xe7"}),(0,a.jsx)(o.ss,{className:"text-center",children:"Tip"})]})}),(0,a.jsx)(o.RM,{children:et.map(e=>(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.pj,{className:"font-medium",children:e.name}),(0,a.jsxs)(o.pj,{className:"text-right",children:[(100*r[e.id]||0).toFixed(2),"%"]}),(0,a.jsx)(o.pj,{className:"text-center",children:(0,a.jsx)(j.X,{checked:R.includes(e.id),onCheckedChange:t=>ei(e.id,t)})}),(0,a.jsx)(o.pj,{className:"text-center",children:(0,a.jsxs)(k,{value:F[e.id]?"benefit":"cost",onValueChange:t=>en(e.id,t),children:[(0,a.jsx)(C,{className:"w-[100px] mx-auto",children:(0,a.jsx)(w,{placeholder:"Tip"})}),(0,a.jsxs)(T,{children:[(0,a.jsx)(I,{value:"benefit",children:"Fayda"}),(0,a.jsx)(I,{value:"cost",children:"Maliyet"})]})]})})]},e.id))})]}),(0,a.jsxs)(d.bZ,{className:"bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-900/30",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"}),(0,a.jsxs)(d.X,{className:"text-yellow-800 dark:text-yellow-200",children:["Her kriterin 'Fayda' (daha y\xfcksek daha iyi) veya 'Maliyet' (daha d\xfcş\xfck daha iyi) tipi TOPSIS hesaplaması i\xe7in \xf6nemlidir. L\xfctfen doğru se\xe7imi yapın. ",(0,a.jsx)("br",{}),"Toplu ağırlıklar i\xe7in ",(0,a.jsx)("strong",{children:"Toplu Ağırlıklar"})," sayfasını ziyaret edin."]})]})]}),y.length>0&&(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"TOPSIS Sonu\xe7ları"}),(0,a.jsxs)(o.iA,{children:[(0,a.jsx)(o.xD,{children:(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.ss,{children:"Sıra"}),(0,a.jsx)(o.ss,{children:"S\xfcr\xfcc\xfc Sicil No"}),(0,a.jsx)(o.ss,{className:"text-right",children:"Yakınlık Katsayısı (C*)"}),(0,a.jsx)(o.ss,{className:"text-right",children:"TOPSIS Puanı"})]})}),(0,a.jsx)(o.RM,{children:y.map(e=>(0,a.jsxs)(o.SC,{children:[(0,a.jsx)(o.pj,{className:"font-medium",children:e.rank}),(0,a.jsx)(o.pj,{children:e.driverId}),(0,a.jsx)(o.pj,{className:"text-right",children:e.closenessCoefficient.toFixed(4)}),(0,a.jsx)(o.pj,{className:"text-right",children:(100*e.closenessCoefficient).toFixed(2)})]},e.driverId))})]}),(0,a.jsxs)("div",{className:"mt-6 flex flex-wrap gap-4 justify-center",children:[(0,a.jsxs)(l.z,{onClick:()=>{if(0===y.length){N("Dışa aktarılacak TOPSIS sonucu bulunamadı.");return}let e=[["Sıra","S\xfcr\xfcc\xfc Sicil No","Yakınlık Katsayısı (C*)","TOPSIS Puanı"]];y.forEach(t=>{e.push([t.rank,t.driverId,t.closenessCoefficient.toFixed(4),(100*t.closenessCoefficient).toFixed(2)])});let t=x.P6.aoa_to_sheet(e),r=[["S\xfcr\xfcc\xfc Sicil No",...et.map(e=>e.name)]];y.forEach(e=>{let t=[e.driverId];et.forEach(r=>{var a,s;t.push(null!==(s=null===(a=e.normalizedPerformance[r.id])||void 0===a?void 0:a.toFixed(6))&&void 0!==s?s:"")}),r.push(t)});let a=x.P6.aoa_to_sheet(r),s=[["S\xfcr\xfcc\xfc Sicil No",...et.map(e=>e.name)]];y.forEach(e=>{let t=[e.driverId];et.forEach(r=>{var a,s;t.push(null!==(s=null===(a=e.weightedNormalizedPerformance[r.id])||void 0===a?void 0:a.toFixed(6))&&void 0!==s?s:"")}),s.push(t)});let l=x.P6.aoa_to_sheet(s),i=[["Kriter","İdeal (A+)","Anti-İdeal (A-)"]];if(y.length>0){let e=y[0];et.forEach(t=>{var r,a,s,l;i.push([t.name,null!==(s=null===(r=e.idealPositive[t.id])||void 0===r?void 0:r.toFixed(6))&&void 0!==s?s:"",null!==(l=null===(a=e.idealNegative[t.id])||void 0===a?void 0:a.toFixed(6))&&void 0!==l?l:""])})}let n=x.P6.aoa_to_sheet(i),o=[["S\xfcr\xfcc\xfc Sicil No","d+ (İdeal Uzaklık)","d- (Anti-İdeal Uzaklık)","Yakınlık Katsayısı (C*)"]];y.forEach(e=>{o.push([e.driverId,e.distanceToPositive.toFixed(6),e.distanceToNegative.toFixed(6),e.closenessCoefficient.toFixed(6)])});let d=x.P6.aoa_to_sheet(o),c=x.P6.book_new();x.P6.book_append_sheet(c,t,"TOPSIS Sonu\xe7ları"),x.P6.book_append_sheet(c,a,"Normalize Matris"),x.P6.book_append_sheet(c,l,"Ağırlıklı Normalize"),x.P6.book_append_sheet(c,n,"İdeal \xc7\xf6z\xfcmler"),x.P6.book_append_sheet(c,d,"Uzaklıklar ve C*"),x.NC(c,"TOPSIS_Tum_Asamalar.xlsx")},className:"flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"})," Excel Olarak İndir"]}),(0,a.jsxs)(l.z,{onClick:()=>{if(0===y.length){N("Dışa aktarılacak TOPSIS sonucu bulunamadı.");return}let e=new p.ZP;e.setFontSize(18),e.text("TOPSIS Hesaplama Sonu\xe7ları",14,22),e.setFontSize(12),e.autoTable({startY:30,head:[["S\xfcr\xfcc\xfc Sicil No","Yakınlık Katsayısı","TOPSIS Puanı","Sıra"]],body:y.map(e=>[e.driverId,e.closenessCoefficient.toFixed(4),(100*e.closenessCoefficient).toFixed(2),e.rank]),theme:"grid",styles:{fontSize:9,cellPadding:2},headStyles:{fillColor:[23,162,184]},margin:{left:14,right:14}}),e.save("TOPSIS_Sonuclari.pdf")},className:"flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"})," PDF Olarak İndir"]})]})]}),(0,a.jsxs)(l.z,{onClick:()=>{let e=x.P6.book_new(),t=x.P6.aoa_to_sheet([["Driver ID","Performance"],["Driver 1",.85],["Driver 2",.78]]);x.P6.book_append_sheet(e,t,"Current Table");let r=(function(e,t){if(!e||0===e.length)return[];let r=(0,g.RR)().map(e=>e.id),a={},s={};for(let t of r)s[t]=e.reduce((e,r)=>{let a="number"==typeof r[t]?r[t]:0;return e+a*a},0),0===s[t]&&(s[t]=1e-10);for(let t of e)for(let e of(a[t.driverId]={},r)){let r="number"==typeof t[e]?t[e]:0,l=Math.sqrt(s[e]);a[t.driverId][e]=r/l}let l={};for(let e in a)for(let s of(l[e]={},r))l[e][s]=a[e][s]*(t[s]||0);let i={},n={};for(let t of r){let r=(0,g.rc)(t),a=e.map(e=>l[e.driverId][t]);if(a.length>0){let e=Math.max(...a),s=Math.min(...a);console.log("Criterion ".concat(t,": isBenefit=").concat(r,", min=").concat(s,", max=").concat(e)),r?(i[t]=e,n[t]=s):(i[t]=s,n[t]=e),i[t]===n[t]&&(r?i[t]+=1e-10:n[t]+=1e-10)}else i[t]=1e-10,n[t]=0}let o=[];for(let t of e){let e=t.driverId,s=0,d=0;for(let t of r){let r=l[e][t];s+=Math.pow(r-i[t],2),d+=Math.pow(r-n[t],2)}let c=(s=Math.sqrt(s))+(d=Math.sqrt(d)),u=0;u=c>1e-10?d/c:.5,o.length<3&&console.log("Driver ".concat(e,": d+=").concat(s.toFixed(6),", d-=").concat(d.toFixed(6),", C*=").concat(u.toFixed(6))),o.push({driverId:e,normalizedPerformance:a[e],weightedNormalizedPerformance:l[e],idealPositive:i,idealNegative:n,distanceToPositive:s,distanceToNegative:d,closenessCoefficient:u,rank:0})}return o.sort((e,t)=>t.closenessCoefficient-e.closenessCoefficient),o.forEach((e,t)=>{e.rank=t+1}),o})([],{}).map(e=>[e.driverId,e.closenessCoefficient,e.rank]);r.unshift(["Driver ID","Closeness Coefficient","Rank"]);let a=x.P6.aoa_to_sheet(r);x.P6.book_append_sheet(e,a,"TOPSIS Steps");let s=(0,E.R)([]).weights.map((e,t)=>["Criterion ".concat(t+1),e]);s.unshift(["Criterion","Weight"]);let l=x.P6.aoa_to_sheet(s);x.P6.book_append_sheet(e,l,"AHP Weights"),x.NC(e,"AHP_TOPSIS_Results.xlsx")},className:"mt-8 w-full bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"})," TOPSIS ve AHP Sonu\xe7larını Excel'e Aktar"]})]})]})]})})}},77929:function(e,t,r){"use strict";r.d(t,{Cd:function(){return d},X:function(){return c},bZ:function(){return o}});var a=r(3827),s=r(64090),l=r(49769),i=r(1657);let n=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:r,variant:s,...l}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:s}),r),...l})});o.displayName="Alert";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})});d.displayName="AlertTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...s})});c.displayName="AlertDescription"},54900:function(e,t,r){"use strict";r.d(t,{X:function(){return o}});var a=r(3827),s=r(64090),l=r(86969),i=r(80037),n=r(1657);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.fC,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...s,children:(0,a.jsx)(l.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})})});o.displayName=l.fC.displayName},49842:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var a=r(3827),s=r(64090),l=r(24602),i=r(49769),n=r(1657);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.f,{ref:t,className:(0,n.cn)(o(),r),...s})});d.displayName=l.f.displayName},80831:function(e,t,r){"use strict";r.d(t,{R:function(){return l},_:function(){return s}});var a=r(64090);function s(e,t){let[r,s]=(0,a.useState)(()=>{try{let r=window.localStorage.getItem(e);return r?JSON.parse(r):t}catch(e){return console.log(e),t}}),l=(0,a.useCallback)(t=>{try{let a=t instanceof Function?t(r):t;s(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(e){console.log(e)}},[e,r]);return[r,l]}function l(e){return{getItem:(0,a.useCallback)(()=>{try{return window.localStorage.getItem(e)}catch(e){return console.error("Error reading from localStorage:",e),null}},[e]),setItem:(0,a.useCallback)(t=>{try{window.localStorage.setItem(e,t)}catch(e){console.error("Error writing to localStorage:",e)}},[e]),removeItem:(0,a.useCallback)(()=>{try{window.localStorage.removeItem(e)}catch(e){console.error("Error removing from localStorage:",e)}},[e])}}},75083:function(e,t,r){"use strict";r.d(t,{pm:function(){return m}});var a=r(64090);let s=0,l=new Map,i=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=n(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=a.useState(d);return a.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},74889:function(e,t,r){"use strict";r.d(t,{R:function(){return s},q:function(){return l}});let a=[0,0,.58,.9,1.12,1.24,1.32,1.41,1.45,1.49];function s(e){let t=e.length;if(0===t)return{weights:[],cr:0,isConsistent:!0};if(1===t)return{weights:[1],cr:0,isConsistent:!0};let r=Array(t).fill(0).map(()=>Array(t).fill(0)),s=Array(t).fill(0);for(let r=0;r<t;r++)for(let a=0;a<t;a++)s[r]+=e[a][r];for(let a=0;a<t;a++)for(let l=0;l<t;l++)r[a][l]=e[a][l]/s[l];let l=Array(t).fill(0);for(let e=0;e<t;e++){for(let a=0;a<t;a++)l[e]+=r[e][a];l[e]/=t}let i=Array(t).fill(0);for(let r=0;r<t;r++)for(let a=0;a<t;a++)i[r]+=e[r][a]*l[a];let n=0,o=0;for(let e=0;e<t;e++)0!==l[e]&&(n+=i[e]/l[e],o++);let d=((n=o>0?n/o:0)-t)/(t-1),c=a[t-1],u=0!==c?d/c:0;return{weights:l,cr:u,isConsistent:u<.1}}function l(e){let t=s(e.mainCriteria.matrix),r=t.weights,a=t.cr,l=t.isConsistent,i={},n={},o={};for(let t of Object.keys(e.subCriteria)){let r=e.subCriteria[t].matrix,a=e.subCriteria[t].ids;if(a.length>1){let e=s(r);i[t]=e.weights,n[t]=e.cr,o[t]=e.isConsistent}else 1===a.length?i[t]=[1]:i[t]=[],n[t]=0,o[t]=!0}let d={},c={},u={};for(let t of Object.keys(e.subSubCriteria)){let r=e.subSubCriteria[t].matrix,a=e.subSubCriteria[t].ids;if(a.length>1){let e=s(r);d[t]=e.weights,c[t]=e.cr,u[t]=e.isConsistent}else 1===a.length?d[t]=[1]:d[t]=[],c[t]=0,u[t]=!0}let m={},h=[];e.mainCriteria.ids.forEach((t,a)=>{let s=e.criteriaMap[t],l=r[a];if(s.isLeaf)m[t]=l,h.push(t);else if(s.children&&s.children.length>0){var n;null===(n=e.subCriteria[t])||void 0===n||n.ids.forEach((r,a)=>{var s,n;let o=e.criteriaMap[r],c=(null===(s=i[t])||void 0===s?void 0:s[a])||0;o.isLeaf?(m[r]=l*c,h.push(r)):o.children&&o.children.length>0&&(null===(n=e.subSubCriteria[r])||void 0===n||n.ids.forEach((e,t)=>{var a;let s=(null===(a=d[r])||void 0===a?void 0:a[t])||0;m[e]=l*c*s,h.push(e)}))})}});let f=Object.values(m).reduce((e,t)=>e+t,0);for(let e in m)m[e]=m[e]/f;let x=l&&Object.values(o).every(e=>e)&&Object.values(u).every(e=>e);return{mainWeights:r,mainCR:a,mainConsistent:l,subWeights:i,subCRs:n,subConsistent:o,subSubWeights:d,subSubCRs:c,subSubConsistent:u,globalWeights:m,leafCriteria:h,isOverallConsistent:x}}}},function(e){e.O(0,[425,505,581,26,528,834,424,943,932,971,69,744],function(){return e(e.s=13010)}),_N_E=e.O()}]);